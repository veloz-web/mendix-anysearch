<?xml version="1.0" encoding="utf-8" ?>
<widget id="com.qvine.soar.widgets.gridsearch.GridSearch" pluginWidget="true" needsEntityContext="true"
    xmlns="http://www.mendix.com/widget/1.0/"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mendix.com/widget/1.0/ ../node_modules/mendix/custom_widget.xsd">
    <name>GridSearch</name>
    <description>A modern, consolidated widget for filtering Mendix data grids.</description>
    <icon/>
    <properties>
        <!-- GENERAL SETTINGS -->
        <propertyGroup caption="General">
            <property key="targetGridName" type="string" required="true">
                <caption>Grid Name</caption>
                <category>General</category>
                <description>The name of the Data Grid or Gallery widget to target.</description>
            </property>
            <property key="filterType" type="enumeration" defaultValue="multifield">
                <caption>Filter Type</caption>
                <category>General</category>
                <description>Select the type of UI and logic for this filter instance.</description>
                <enumerationValues>
                    <enumerationValue key="multifield">Text Search (Multifield)</enumerationValue>
                    <enumerationValue key="button">Button Filter</enumerationValue>
                    <enumerationValue key="dropdownStatic">Dropdown (Static)</enumerationValue>
                    <enumerationValue key="localCheckbox">Checkbox (Enum/Boolean)</enumerationValue>
                    <enumerationValue key="resetButton">Reset Button</enumerationValue>
                    <enumerationValue key="anysearch">Filter Applicator (AnySearch)</enumerationValue>
                </enumerationValues>
            </property>
        </propertyGroup>

        <!-- HELPER OBJECT ATTRIBUTES (COMMON TO MOST FILTERS) -->
        <propertyGroup caption="Helper Object Attribute">
             <property key="xpathAttribute" type="attribute" required="false">
                <caption>XPath Attribute</caption>
                <category>Behavior</category>
                <description>Attribute (string) on the helper object that will store this filter's XPath constraint.</description>
                <attributeTypes>
                    <attributeType name="String"/>
                </attributeTypes>
            </property>
        </propertyGroup>

        <!-- MULTIFIELD SETTINGS -->
        <propertyGroup caption="Text Search Settings" required="false">
            <property key="searchAttributes" type="object" isList="true" required="false">
                <caption>Search Attributes</caption>
                <description>The attributes that will be considered when searching.</description>
                <properties>
                    <property key="searchAttributeParam" type="attribute" required="true">
                        <caption>Search Attribute</caption>
                        <description>The attribute to search on (can be over an association).</description>
                        <attributeTypes>
                            <attributeType name="String"/>
                            <attributeType name="Integer"/>
                            <attributeType name="Long"/>
                            <attributeType name="Decimal"/>
                        </attributeTypes>
                    </property>
                    <property key="searchMethodParam" type="enumeration" defaultValue="contains">
                        <caption>Search Method</caption>
                        <description>The comparison method to use.</description>
                        <enumerationValues>
                            <enumerationValue key="contains">Contains</enumerationValue>
                            <enumerationValue key="startswith">Starts With</enumerationValue>
                        </enumerationValues>
                    </property>
                </properties>
            </property>
            <property key="minCharacters" type="integer" defaultValue="0">
                <caption>Minimum Characters</caption>
                <description>The minimum number of characters required to trigger a search.</description>
            </property>
            <property key="placeholderText" type="translatableString" required="false">
                <caption>Placeholder Text</caption>
                <description>The placeholder text for the search input.</description>
            </property>
            <property key="renderAsTextarea" type="boolean" defaultValue="false">
                <caption>Render as Textarea</caption>
            </property>
            <property key="textareaRows" type="integer" defaultValue="5">
                <caption>Textarea Rows</caption>
            </property>
            <property key="allowOrConditions" type="boolean" defaultValue="false">
                <caption>Allow 'OR' Conditions</caption>
                <description>If enabled, the search text can be split into multiple terms.</description>
            </property>
            <property key="splitString" type="string" defaultValue=" OR ">
                <caption>'OR' Split String</caption>
                <description>The string used to split the search text into multiple terms (e.g., " OR ", ",").</description>
            </property>
        </propertyGroup>

        <!-- BUTTON FILTER SETTINGS -->
        <propertyGroup caption="Button Filter Settings" required="false">
            <property key="searchOptions" type="object" isList="true" required="false">
                <caption>Filter Buttons</caption>
                <description>Define the buttons and their corresponding XPath filters.</description>
                <properties>
                    <property key="key" type="string" required="true" defaultValue="">
                        <caption>Key</caption>
                        <description>A unique key for this option.</description>
                    </property>
                    <property key="optionLabel" type="translatableString" required="true">
                        <caption>Button Label</caption>
                    </property>
                    <property key="optionXPath" type="string" required="true" multiline="true">
                        <caption>XPath Constraint</caption>
                        <description>The XPath constraint to apply (e.g., [Status = 'Active']).</description>
                    </property>
                    <property key="isDefault" type="boolean" defaultValue="false">
                        <caption>Selected by Default</caption>
                    </property>
                </properties>
            </property>
            <property key="allowMultiselect" type="boolean" defaultValue="false">
                <caption>Allow Multi-select</caption>
            </property>
            <property key="multiselectBehavior" type="enumeration" defaultValue="or">
                <caption>Multi-select Logic</caption>
                <enumerationValues>
                    <enumerationValue key="or">OR</enumerationValue>
                    <enumerationValue key="and">AND</enumerationValue>
                </enumerationValues>
            </property>
            <property key="activeClass" type="string" defaultValue="btn-primary">
                <caption>Active CSS Class</caption>
                <description>The CSS class applied to active/selected buttons.</description>
            </property>
            <property key="groupedButtons" type="boolean" defaultValue="true">
                <caption>Group Buttons</caption>
                <description>Render buttons inside a '.btn-group' container.</description>
            </property>
        </propertyGroup>

        <!-- STATIC DROPDOWN SETTINGS -->
        <propertyGroup caption="Static Dropdown Settings" required="false">
            <!-- Re-uses the same 'searchOptions' property structure as the Button Filter -->
            <property key="blankOptionLabel" type="translatableString" required="false">
                 <caption>Blank Option Label</caption>
                 <description>The text for the first, empty option in the dropdown.</description>
            </property>
        </propertyGroup>

        <!-- LOCAL CHECKBOX SETTINGS -->
        <propertyGroup caption="Local Checkbox Settings" required="false">
            <property key="searchAttribute" type="attribute" required="false">
                <caption>Attribute (Enum/Bool)</caption>
                <description>The Enumeration or Boolean attribute to create checkboxes for.</description>
                <attributeTypes>
                    <attributeType name="Enum"/>
                    <attributeType name="Boolean"/>
                </attributeTypes>
            </property>
            <property key="booleanCaption" type="translatableString" required="false">
                <caption>Boolean Caption</caption>
                <description>The label for the checkbox when using a Boolean attribute.</description>
            </property>
        </propertyGroup>

        <!-- RESET BUTTON SETTINGS -->
        <propertyGroup caption="Reset Button Settings" required="false">
            <property key="onClearAction" type="action" required="false">
                <caption>On Clear Action</caption>
                <description>The Nanoflow or Microflow to execute when the button is clicked.</description>
            </property>
            <property key="buttonCaption" type="translatableString" required="false">
                <caption>Button Caption</caption>
            </property>
        </propertyGroup>

        <!-- ANYSEARCH (APPLICATOR) SETTINGS -->
        <propertyGroup caption="Filter Applicator Settings" required="false">
            <property key="sortAttribute" type="attribute" required="false">
              <caption>Sorting Attribute</caption>
              <description>Attribute (string) on the helper object that contains the sort structure.</description>
              <attributeTypes><attributeType name="String"/></attributeTypes>
            </property>
            <property key="pagesizeAttribute" type="attribute" required="false">
              <caption>Page Size Attribute</caption>
              <description>Attribute (integer) on the helper object that contains the page size.</description>
              <attributeTypes><attributeType name="Integer"/></attributeTypes>
            </property>
            <property key="offsetAttribute" type="attribute" required="false">
              <caption>Offset Attribute</caption>
              <description>Attribute (integer) on the helper object that contains the paging offset.</description>
              <attributeTypes><attributeType name="Integer"/></attributeTypes>
            </property>
        </propertyGroup>
    </properties>
</widget>